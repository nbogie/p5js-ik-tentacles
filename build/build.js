"use strict";
var Palette = (function () {
    function Palette() {
    }
    Palette.getColors = function () {
        return [
            color(250, 105, 0),
            color(105, 210, 231),
            color(167, 219, 216),
            color(243, 134, 48)
        ];
    };
    Palette.randomColor = function () {
        return random(Palette.getColors());
    };
    return Palette;
}());
var Particle = (function () {
    function Particle(pos) {
        this.pos = pos.copy();
    }
    Particle.prototype.draw = function () {
        noStroke();
        fill("black");
        rectMode(CENTER);
        square(this.pos.x, this.pos.y, 3);
        fill(0, 20);
    };
    Particle.prototype.setPosition = function (pos) {
        this.pos.x = pos.x;
        this.pos.y = pos.y;
    };
    Particle.createRandom = function () {
        return new Particle(randomScreenPosition());
    };
    return Particle;
}());
function randomColor() {
    colorMode(HSB, 100);
    return color(random(100), 100, 100);
}
var Segment = (function () {
    function Segment(id, a, b, target, thicknessScale, maxThickness, myHue) {
        this.id = id;
        this.a = a.copy();
        this.b = b.copy();
        this.isFixed = false;
        this.len = a.dist(b);
        colorMode(HSB, 100);
        this.target = target;
        this.myHue = myHue;
        var sat = 50;
        var bright = 50;
        this.myColor = color(this.myHue, sat, random(bright - 10, bright + 10));
        this.edgeColor = color(this.myHue, sat, bright - 20);
        this.thickness = thicknessScale * maxThickness * random(0.9, 1.1);
        this.targetColor = randomColor();
    }
    Segment.prototype.pos = function () {
        return this.a.copy();
    };
    Segment.prototype.translate = function (offset) {
        this.a.add(offset);
        this.b.add(offset);
    };
    Segment.prototype.drawShadow = function () {
        var off = createVector(20, 10);
        stroke(color(this.myHue, 0, 0, 20));
        noFill();
        strokeWeight(this.thickness);
        line(off.x + this.a.x, off.y + this.a.y, off.x + this.b.x, off.y + this.b.y);
    };
    Segment.prototype.drawSilhoutte = function () {
        noFill();
        stroke(10);
        strokeWeight(this.thickness);
        line(this.a.x, this.a.y, this.b.x, this.b.y);
    };
    Segment.prototype.drawInner = function () {
        stroke(this.myColor);
        strokeWeight(this.thickness * 0.8);
        line(this.a.x, this.a.y, this.b.x, this.b.y);
    };
    Segment.drawCrosshairAt = function (pos, colr) {
        strokeWeight(1.8);
        stroke(colr);
        push();
        translate(pos.x, pos.y);
        line(-8, 0, 8, 0);
        line(0, -8, 0, 8);
        pop();
    };
    Segment.prototype.midPoint = function () {
        return this.a.copy().lerp(this.b, 0.5);
    };
    Segment.createRandomAt = function (id, posA, target, thicknessScale, maxThickness, len, myHue) {
        var p1 = posA.copy();
        var p2 = p1.copy().add(p5.Vector.random2D().mult(len));
        return new Segment(id, p1, p2, target, thicknessScale, maxThickness, myHue);
    };
    Segment.prototype.update = function () {
        this.seekTarget(this.target.pos());
    };
    Segment.prototype.seekTarget = function (targetPos) {
        var deltaToTarget = targetPos.copy().sub(this.a);
        this.deltaToTarget = deltaToTarget;
        this.a = targetPos.copy().add(deltaToTarget
            .copy()
            .normalize()
            .mult(-this.len));
        this.b = targetPos.copy();
    };
    return Segment;
}());
var Tentacle = (function () {
    function Tentacle(numSegments, fullLength, maxThickness, baseHueOf100, provideTarget) {
        var _this = this;
        var myHue = random(baseHueOf100 - 5, baseHueOf100 + 5);
        var avgSegmentLength = fullLength / numSegments;
        this.provideTarget = provideTarget;
        var prevPos = createVector(random(width * 0.4, width * 0.6), height * 1.1);
        this.segments = collectDistributedBetween(numSegments, 0, 0.9, function (thickness, ix) {
            var segment = Segment.createRandomAt("Seg" + ix, prevPos, null, 1 - thickness, maxThickness, avgSegmentLength, myHue);
            prevPos = segment.b.copy();
            return segment;
        });
        this.segments[0].isFixed = true;
        var thinnerSegment = null;
        this.segments.reverse().forEach(function (seg) {
            seg.target = thinnerSegment ? thinnerSegment : _this.provideTarget;
            thinnerSegment = seg;
        });
        this.segments.reverse();
    }
    Tentacle.prototype.lastSegment = function () {
        return this.segments.length > 0
            ? this.segments[this.segments.length - 1]
            : undefined;
    };
    Tentacle.prototype.firstSegment = function () {
        return this.segments.length > 0 ? this.segments[0] : undefined;
    };
    Tentacle.prototype.setNewTargetProvider = function (givenTargetProvider) {
        this.provideTarget = givenTargetProvider;
        this.lastSegment().target = givenTargetProvider;
    };
    Tentacle.prototype.update = function () {
        var originalLockedPos = this.segments[0].a.copy();
        this.segments.reverse();
        for (var _i = 0, _a = this.segments; _i < _a.length; _i++) {
            var s = _a[_i];
            s.update();
        }
        this.segments.reverse();
        var moveBackDelta = originalLockedPos
            .copy()
            .sub(this.segments[0].a.copy());
        this.segments.forEach(function (s) { return s.translate(moveBackDelta); });
    };
    Tentacle.prototype.draw = function () {
        if (appOptions.shouldDrawShadows) {
            for (var _i = 0, _a = this.segments; _i < _a.length; _i++) {
                var s = _a[_i];
                s.drawShadow();
            }
        }
        for (var _b = 0, _c = this.segments; _b < _c.length; _b++) {
            var s = _c[_b];
            s.drawSilhoutte();
        }
        for (var _d = 0, _e = this.segments; _d < _e.length; _d++) {
            var s = _e[_d];
            s.drawInner();
        }
    };
    return Tentacle;
}());
function randomScreenPosition() {
    return createVector(random(width), random(height));
}
function centerScreenPos() {
    return createVector(width / 2, height / 2);
}
function randomInt(min, max) {
    return round(random(min, max));
}
function translateToVec(pos) {
    translate(pos.x, pos.y);
}
function rotateVertexAround(vertex, rotOrigin, angleRad) {
    return vertex
        .copy()
        .sub(rotOrigin)
        .rotate(angleRad)
        .add(rotOrigin);
}
function minBy(list, fn) {
    if (list.length < 0) {
        return undefined;
    }
    var recordItem = list[0];
    var recordWeight = fn(list[0]);
    for (var _i = 0, list_1 = list; _i < list_1.length; _i++) {
        var item = list_1[_i];
        var weight = fn(item);
        if (weight > recordWeight) {
            recordWeight = weight;
            recordItem = item;
        }
    }
    return recordItem;
}
function repeat(num, fn) {
    for (var i = 0; i < num; i++) {
        fn(i);
    }
}
function distributeUpTo(total, max, fn) {
    repeat(total, function (ix) {
        var val = (ix * max) / total;
        return fn(val);
    });
}
function collectDistributedBetween(numSamples, min, max, fn) {
    var result = [];
    distributeBetween(numSamples, min, max, function (v, ix) { return result.push(fn(v, ix)); });
    return result;
}
function distributeBetween(numSamples, min, max, fn) {
    repeat(numSamples, function (ix) {
        var range = max - min;
        var val = min + (ix * range) / numSamples;
        return fn(val, ix);
    });
}
function averageVectors(vs) {
    if (vs.length < 1) {
        return createVector(0, 0);
    }
    return vs.reduce(function (v1, v2) { return v1.copy().add(v2); }, vs[0]).div(vs.length);
}
function randomBoolean() {
    return Math.random() > 0.5;
}
function mousePosAsVector() {
    return createVector(mouseX, mouseY);
}
function collect(n, fn) {
    var res = [];
    for (var i = 0; i < n; i++) {
        res.push(fn(i));
    }
    return res;
}
p5.disableFriendlyErrors = true;
var defaultAppOptions = {
    shouldDrawShadows: true
};
var appOptions = defaultAppOptions;
var gNumTentacles = 5;
var gTentacles = [];
var lovecraftQuotes = [
    "It was not meant that we should voyage far",
    "A mountain walked or stumbled",
    "In his house at R'lyeh, dead Cthulu waits dreaming"
];
function randomAppOptions() {
    return {
        shouldDrawShadows: randomBoolean()
    };
}
function mouseHasMoved() {
    return dist(pmouseX, pmouseY, mouseX, mouseY) > 0;
}
function noisyMousePos(phase) {
    var amp = map(sin(frameCount / 20), -1, 1, 10, 40);
    var offsetX = map(noise(3 * phase + frameCount / 20), 0, 1, -amp, amp);
    var offsetY = map(noise(4 * phase + frameCount / 20), 0, 1, -amp, amp);
    return mousePosAsVector().add(createVector(offsetX, offsetY));
}
function makeTargetProvider(phase) {
    var perliner = makePerlinNoisePosFn(phase);
    return { pos: function () { return (mouseHasMoved() ? noisyMousePos(phase) : perliner()); } };
}
function makePerlinNoisePosFn(phase) {
    return function () {
        return createVector(map(noise(phase + frameCount / 100), 0, 1, width / 2 - height * 0.3, width / 2 + height * 0.3), height * noise(88888 + phase + frameCount / 100));
    };
}
function rebuildTentacles() {
    var baseHue = random(100);
    gTentacles = collect(gNumTentacles, function (ix) {
        var targetProvider = makeTargetProvider(ix * 1000);
        return new Tentacle(200, height, random(80, 100), baseHue, targetProvider);
    });
}
function toggleShouldCastShadows() {
    appOptions.shouldDrawShadows = !appOptions.shouldDrawShadows;
}
function mousePressed() {
    rebuildTentacles();
}
function keyPressed() {
    if (key == "s") {
        toggleShouldCastShadows();
    }
}
function setup() {
    var myCanvas = createCanvas(windowWidth, windowHeight);
    myCanvas.parent(document.body);
    myCanvas.style("z-index", "-1");
    myCanvas.position(0, 0);
    rebuildTentacles();
}
function update() {
    gTentacles[0].setNewTargetProvider({ pos: function () { return getPosOfTargetWord().pos; } });
    gTentacles.forEach(function (t) { return t.update(); });
}
function draw() {
    update();
    background(0);
    fill("black");
    noStroke();
    gTentacles.forEach(function (t) { return t.draw(); });
    markTargetWord();
}
function getTargetWordElem() {
    return document.getElementById("targetword");
}
function getPosOfTargetWord() {
    var el = getTargetWordElem();
    var b = el.getBoundingClientRect();
    return {
        left: b.left,
        right: b.right,
        top: b.top,
        bottom: b.bottom,
        width: b.width,
        height: b.height,
        pos: createVector(b.left + b.width / 2, b.top + b.height / 2)
    };
}
function markTargetWord() {
    var p = getPosOfTargetWord();
    noFill();
    rectMode(CENTER);
    stroke("red");
    rect(p.pos.x, p.pos.y, p.width, p.height);
}
function catchTargetWord() {
    getTargetWordElem().style = "visibility:hidden";
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGQuanMiLCJzb3VyY2VSb290IjoiLi9qcy8iLCJzb3VyY2VzIjpbImluZGV4LnRzIiwiUGFsZXR0ZS50cyIsIlBhcnRpY2xlLnRzIiwiU2VnbWVudC50cyIsIlRlbnRhY2xlLnRzIiwiVXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDO0FDQWI7SUFBQTtJQVlBLENBQUM7SUFYUSxpQkFBUyxHQUFoQjtRQUNFLE9BQU87WUFDTCxLQUFLLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7WUFDbEIsS0FBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxDQUFDO1lBQ3BCLEtBQUssQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQztZQUNwQixLQUFLLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7U0FDcEIsQ0FBQztJQUNKLENBQUM7SUFDTSxtQkFBVyxHQUFsQjtRQUNFLE9BQU8sTUFBTSxDQUFDLE9BQU8sQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFDSCxjQUFDO0FBQUQsQ0FBQyxBQVpELElBWUM7QUNaRDtJQUdFLGtCQUFZLEdBQWM7UUFDeEIsSUFBSSxDQUFDLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUNELHVCQUFJLEdBQUo7UUFDRSxRQUFRLEVBQUUsQ0FBQztRQUNYLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNkLFFBQVEsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNqQixNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7UUFDbEMsSUFBSSxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQztJQUNkLENBQUM7SUFFRCw4QkFBVyxHQUFYLFVBQVksR0FBYztRQUN4QixJQUFJLENBQUMs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UUFDTCxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUk7UUFDWixLQUFLLEVBQUUsQ0FBQyxDQUFDLEtBQUs7UUFDZCxHQUFHLEVBQUUsQ0FBQyxDQUFDLEdBQUc7UUFDVixNQUFNLEVBQUUsQ0FBQyxDQUFDLE1BQU07UUFDaEIsS0FBSyxFQUFFLENBQUMsQ0FBQyxLQUFLO1FBQ2QsTUFBTSxFQUFFLENBQUMsQ0FBQyxNQUFNO1FBQ2hCLEdBQUcsRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDO0tBQzlELENBQUM7QUFDSixDQUFDO0FBRUQsU0FBUyxjQUFjO0lBQ3JCLElBQU0sQ0FBQyxHQUFrQixrQkFBa0IsRUFBRSxDQUFDO0lBQzlDLE1BQU0sRUFBRSxDQUFDO0lBQ1QsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2pCLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNkLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUM1QyxDQUFDO0FBRUQsU0FBUyxlQUFlO0lBQ3RCLGlCQUFpQixFQUFFLENBQUMsS0FBSyxHQUFHLG1CQUFtQixDQUFDO0FBQ2xELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnA1LmRpc2FibGVGcmllbmRseUVycm9ycyA9IHRydWU7XG5cbmludGVyZmFjZSBBcHBPcHRpb25zIHtcbiAgc2hvdWxkRHJhd1NoYWRvd3M6IGJvb2xlYW47XG59XG5cbmxldCBkZWZhdWx0QXBwT3B0aW9uczogQXBwT3B0aW9ucyA9IHtcbiAgc2hvdWxkRHJhd1NoYWRvd3M6IHRydWVcbn07XG5cbmxldCBhcHBPcHRpb25zOiBBcHBPcHRpb25zID0gZGVmYXVsdEFwcE9wdGlvbnM7XG5cbmNvbnN0IGdOdW1UZW50YWNsZXMgPSA1O1xubGV0IGdUZW50YWNsZXM6IFRlbnRhY2xlW10gPSBbXTtcblxuY29uc3QgbG92ZWNyYWZ0UXVvdGVzID0gW1xuICBcIkl0IHdhcyBub3QgbWVhbnQgdGhhdCB3ZSBzaG91bGQgdm95YWdlIGZhclwiLFxuICBcIkEgbW91bnRhaW4gd2Fsa2VkIG9yIHN0dW1ibGVkXCIsXG4gIFwiSW4gaGlzIGhvdXNlIGF0IFInbHllaCwgZGVhZCBDdGh1bHUgd2FpdHMgZHJlYW1pbmdcIlxuXTtcblxuZnVuY3Rpb24gcmFuZG9tQXBwT3B0aW9ucygpOiBBcHBPcHRpb25zIHtcbiAgcmV0dXJuIHtcbiAgICBzaG91bGREcmF3U2hhZG93czogcmFuZG9tQm9vbGVhbigpXG4gIH07XG59XG5cbmZ1bmN0aW9uIG1vdXNlSGFzTW92ZWQoKSB7XG4gIHJldHVybiBkaXN0KHBtb3VzZVgsIHBtb3VzZVksIG1vdXNlWCwgbW91c2VZKSA+IDA7XG59XG5cbmZ1bmN0aW9uIG5vaXN5TW91c2VQb3MocGhhc2U6IG51bWJlcikge1xuICAvL3VuZHVsYXRpbmcgYXR0ZW50aW9uXG4gIGNvbnN0IGFtcCA9IG1hcChzaW4oZnJhbWVDb3VudCAvIDIwKSwgLTEsIDEsIDEwLCA0MCk7XG5cbiAgY29uc3Qgb2Zmc2V0WCA9IG1hcChub2lzZSgzICogcGhhc2UgKyBmcmFtZUNvdW50IC8gMjApLCAwLCAxLCAtYW1wLCBhbXApO1xuICBjb25zdCBvZmZzZXRZID0gbWFwKG5vaXNlKDQgKiBwaGFzZSArIGZyYW1lQ291bnQgLyAyMCksIDAsIDEsIC1hbXAsIGFtcCk7XG4gIHJldHVybiBtb3VzZVBvc0FzVmVjdG9yKCkuYWRkKGNyZWF0ZVZlY3RvcihvZmZzZXRYLCBvZmZzZXRZKSk7XG59XG5cbmZ1bmN0aW9uIG1ha2VUYXJnZXRQcm92aWRlcihwaGFzZTogbnVtYmVyKTogVGFyZ2V0UHJvdmlkZXIge1xuICAvLy9UT0RPOiBuZXZlciBwdXQgYSB0YXJnZXQgY29tcGxldGVseSBvdXQgb2YgcmVhY2ggYXMgc3lzdGVtIHN0cmV0Y2hlc1xuICAvLyBvdXQgdW5uYXR1cmFsbHksIGlub3JnYW5pY2FsbHkgc3RyYWlnaHQuXG4gIC8vL0luc3RlYWQgaWYgdGFyZ2V0IHdvdWxkIGJlIG91dCBvZiByZWFjaCBicmluZyBpdCBqdXN0IHdpdGhpbiByZWFjaCwgb24gc2FtZSBsaW5lLlxuICBjb25zdCBwZXJsaW5lciA9IG1ha2VQZXJsaW5Ob2lzZVBvc0ZuKHBoYXNlKTtcbiAgcmV0dXJuIHsgcG9zOiAoKSA9PiAobW91c2VIYXNNb3ZlZCgpID8gbm9pc3lNb3VzZVBvcyhwaGFzZSkgOiBwZXJsaW5lcigpKSB9O1xufVxuZnVuY3Rpb24gbWFrZVBlcmxpbk5vaXNlUG9zRm4ocGhhc2U6IG51bWJlcikge1xuICByZXR1cm4gKCkgPT5cbiAgICBjcmVhdGVWZWN0b3IoXG4gICAgICBtYXAoXG4gICAgICAgIG5vaXNlKHBoYXNlICsgZnJhbWVDb3VudCAvIDEwMCksXG4gICAgICAgIDAsXG4gICAgICAgIDEsXG4gICAgICAgIHdpZHRoIC8gMiAtIGhlaWdodCAqIDAuMyxcbiAgICAgICAgd2lkdGggLyAyICsgaGVpZ2h0ICogMC4zXG4gICAgICApLFxuICAgICAgaGVpZ2h0ICogbm9pc2UoODg4ODggKyBwaGFzZSArIGZyYW1lQ291bnQgLyAxMDApXG4gICAgKTtcbn1cbmZ1bmN0aW9uIHJlYnVpbGRUZW50YWNsZXMoKSB7XG4gIGNvbnN0IGJhc2VIdWUgPSByYW5kb20oMTAwKTtcbiAgZ1RlbnRhY2xlcyA9IGNvbGxlY3QoZ051bVRlbnRhY2xlcywgaXggPT4ge1xuICAgIGNvbnN0IHRhcmdldFByb3ZpZGVyID0gbWFrZVRhcmdldFByb3ZpZGVyKGl4ICogMTAwMCk7XG4gICAgcmV0dXJuIG5ldyBUZW50YWNsZSgyMDAsIGhlaWdodCwgcmFuZG9tKDgwLCAxMDApLCBiYXNlSHVlLCB0YXJnZXRQcm92aWRlcik7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB0b2dnbGVTaG91bGRDYXN0U2hhZG93cygpIHtcbiAgYXBwT3B0aW9ucy5zaG91bGREcmF3U2hhZG93cyA9ICFhcHBPcHRpb25zLnNob3VsZERyYXdTaGFkb3dzO1xufVxuXG5mdW5jdGlvbiBtb3VzZVByZXNzZWQoKSB7XG4gIHJlYnVpbGRUZW50YWNsZXMoKTtcbn1cbmZ1bmN0aW9uIGtleVByZXNzZWQoKSB7XG4gIGlmIChrZXkgPT0gXCJzXCIpIHtcbiAgICB0b2dnbGVTaG91bGRDYXN0U2hhZG93cygpO1xuICB9XG59XG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gU0VUVVBcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBzZXR1cCgpIHtcbiAgY29uc3QgbXlDYW52YXMgPSBjcmVhdGVDYW52YXMod2luZG93V2lkdGgsIHdpbmRvd0hlaWdodCk7XG4gIG15Q2FudmFzLnBhcmVudChkb2N1bWVudC5ib2R5KTtcbiAgbXlDYW52YXMuc3R5bGUoXCJ6LWluZGV4XCIsIFwiLTFcIik7XG4gIG15Q2FudmFzLnBvc2l0aW9uKDAsIDApO1xuXG4gIHJlYnVpbGRUZW50YWNsZXMoKTtcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFVQREFURVxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmZ1bmN0aW9uIHVwZGF0ZSgpIHtcbiAgZ1RlbnRhY2xlc1swXS5zZXROZXdUYXJnZXRQcm92aWRlcih7IHBvczogKCkgPT4gZ2V0UG9zT2ZUYXJnZXRXb3JkKCkucG9zIH0pO1xuICBnVGVudGFjbGVzLmZvckVhY2godCA9PiB0LnVwZGF0ZSgpKTtcbn1cblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIERSQVdcbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5mdW5jdGlvbiBkcmF3KCkge1xuICB1cGRhdGUoKTtcbiAgYmFja2dyb3VuZCgwKTtcbiAgZmlsbChcImJsYWNrXCIpO1xuICBub1N0cm9rZSgpO1xuICBnVGVudGFjbGVzLmZvckVhY2godCA9PiB0LmRyYXcoKSk7XG4gIG1hcmtUYXJnZXRXb3JkKCk7XG59XG5cbmludGVyZmFjZSBUYXJnZXRXb3JkUG9zIHtcbiAgbGVmdDogbnVtYmVyO1xuICByaWdodDogbnVtYmVyO1xuICB0b3A6IG51bWJlcjtcbiAgYm90dG9tOiBudW1iZXI7XG4gIHdpZHRoOiBudW1iZXI7XG4gIGhlaWdodDogbnVtYmVyO1xuICBwb3M6IHA1LlZlY3Rvcjtcbn1cbmZ1bmN0aW9uIGdldFRhcmdldFdvcmRFbGVtKCkge1xuICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0YXJnZXR3b3JkXCIpO1xufVxuXG5mdW5jdGlvbiBnZXRQb3NPZlRhcmdldFdvcmQoKTogVGFyZ2V0V29yZFBvcyB7XG4gIGNvbnN0IGVsID0gZ2V0VGFyZ2V0V29yZEVsZW0oKTtcbiAgY29uc3QgYiA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICByZXR1cm4ge1xuICAgIGxlZnQ6IGIubGVmdCxcbiAgICByaWdodDogYi5yaWdodCxcbiAgICB0b3A6IGIudG9wLFxuICAgIGJvdHRvbTogYi5ib3R0b20sXG4gICAgd2lkdGg6IGIud2lkdGgsXG4gICAgaGVpZ2h0OiBiLmhlaWdodCxcbiAgICBwb3M6IGNyZWF0ZVZlY3RvcihiLmxlZnQgKyBiLndpZHRoIC8gMiwgYi50b3AgKyBiLmhlaWdodCAvIDIpXG4gIH07XG59XG5cbmZ1bmN0aW9uIG1hcmtUYXJnZXRXb3JkKCk6IHZvaWQge1xuICBjb25zdCBwOiBUYXJnZXRXb3JkUG9zID0gZ2V0UG9zT2ZUYXJnZXRXb3JkKCk7XG4gIG5vRmlsbCgpO1xuICByZWN0TW9kZShDRU5URVIpO1xuICBzdHJva2UoXCJyZWRcIik7XG4gIHJlY3QocC5wb3MueCwgcC5wb3MueSwgcC53aWR0aCwgcC5oZWlnaHQpO1xufVxuXG5mdW5jdGlvbiBjYXRjaFRhcmdldFdvcmQoKTogdm9pZCB7XG4gIGdldFRhcmdldFdvcmRFbGVtKCkuc3R5bGUgPSBcInZpc2liaWxpdHk6aGlkZGVuXCI7XG59XG4iLCJjbGFzcyBQYWxldHRlIHtcbiAgc3RhdGljIGdldENvbG9ycygpIHtcbiAgICByZXR1cm4gW1xuICAgICAgY29sb3IoMjUwLCAxMDUsIDApLFxuICAgICAgY29sb3IoMTA1LCAyMTAsIDIzMSksXG4gICAgICBjb2xvcigxNjcsIDIxOSwgMjE2KSxcbiAgICAgIGNvbG9yKDI0MywgMTM0LCA0OClcbiAgICBdO1xuICB9XG4gIHN0YXRpYyByYW5kb21Db2xvcigpOiBwNS5Db2xvciB7XG4gICAgcmV0dXJuIHJhbmRvbShQYWxldHRlLmdldENvbG9ycygpKTtcbiAgfVxufVxuIiwiY2xhc3MgUGFydGljbGUge1xuICBwb3M6IHA1LlZlY3RvcjtcblxuICBjb25zdHJ1Y3Rvcihwb3M6IHA1LlZlY3Rvcikge1xuICAgIHRoaXMucG9zID0gcG9zLmNvcHkoKTtcbiAgfVxuICBkcmF3KCkge1xuICAgIG5vU3Ryb2tlKCk7XG4gICAgZmlsbChcImJsYWNrXCIpO1xuICAgIHJlY3RNb2RlKENFTlRFUik7XG4gICAgc3F1YXJlKHRoaXMucG9zLngsIHRoaXMucG9zLnksIDMpO1xuICAgIGZpbGwoMCwgMjApO1xuICB9XG5cbiAgc2V0UG9zaXRpb24ocG9zOiBwNS5WZWN0b3IpIHtcbiAgICB0aGlzLnBvcy54ID0gcG9zLng7XG4gICAgdGhpcy5wb3MueSA9IHBvcy55O1xuICB9XG5cbiAgc3RhdGljIGNyZWF0ZVJhbmRvbSgpIHtcbiAgICByZXR1cm4gbmV3IFBhcnRpY2xlKHJhbmRvbVNjcmVlblBvc2l0aW9uKCkpO1xuICB9XG59XG4iLCJmdW5jdGlvbiByYW5kb21Db2xvcigpOiBwNS5Db2xvciB7XG4gIGNvbG9yTW9kZShIU0IsIDEwMCk7XG4gIHJldHVybiBjb2xvcihyYW5kb20oMTAwKSwgMTAwLCAxMDApO1xufVxuY2xhc3MgU2VnbWVudCBpbXBsZW1lbnRzIFRhcmdldFByb3ZpZGVyIHtcbiAgZGVsdGFUb1RhcmdldDogcDUuVmVjdG9yO1xuICBhOiBwNS5WZWN0b3I7XG4gIGI6IHA1LlZlY3RvcjtcbiAgaWQ6IHN0cmluZztcbiAgbXlDb2xvcjogcDUuQ29sb3I7XG4gIGVkZ2VDb2xvcjogcDUuQ29sb3I7XG4gIHRoaWNrbmVzczogbnVtYmVyO1xuICBsZW46IG51bWJlcjtcbiAgaXNGaXhlZDogYm9vbGVhbjtcbiAgdGFyZ2V0OiBUYXJnZXRQcm92aWRlcjtcbiAgdGFyZ2V0Q29sb3I6IHA1LkNvbG9yO1xuICBteUh1ZTogbnVtYmVyO1xuICBjb25zdHJ1Y3RvcihcbiAgICBpZDogc3RyaW5nLFxuICAgIGE6IHA1LlZlY3RvcixcbiAgICBiOiBwNS5WZWN0b3IsXG4gICAgdGFyZ2V0OiBUYXJnZXRQcm92aWRlcixcbiAgICB0aGlja25lc3NTY2FsZTogbnVtYmVyLFxuICAgIG1heFRoaWNrbmVzczogbnVtYmVyLFxuICAgIG15SHVlOiBudW1iZXJcbiAgKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICAgIHRoaXMuYSA9IGEuY29weSgpO1xuICAgIHRoaXMuYiA9IGIuY29weSgpO1xuICAgIHRoaXMuaXNGaXhlZCA9IGZhbHNlO1xuICAgIHRoaXMubGVuID0gYS5kaXN0KGIpO1xuICAgIGNvbG9yTW9kZShIU0IsIDEwMCk7XG4gICAgdGhpcy50YXJnZXQgPSB0YXJnZXQ7XG4gICAgdGhpcy5teUh1ZSA9IG15SHVlO1xuICAgIGNvbnN0IHNhdCA9IDUwO1xuICAgIGNvbnN0IGJyaWdodCA9IDUwO1xuICAgIHRoaXMubXlDb2xvciA9IGNvbG9yKHRoaXMubXlIdWUsIHNhdCwgcmFuZG9tKGJyaWdodCAtIDEwLCBicmlnaHQgKyAxMCkpO1xuICAgIHRoaXMuZWRnZUNvbG9yID0gY29sb3IodGhpcy5teUh1ZSwgc2F0LCBicmlnaHQgLSAyMCk7XG4gICAgdGhpcy50aGlja25lc3MgPSB0aGlja25lc3NTY2FsZSAqIG1heFRoaWNrbmVzcyAqIHJhbmRvbSgwLjksIDEuMSk7XG4gICAgdGhpcy50YXJnZXRDb2xvciA9IHJhbmRvbUNvbG9yKCk7XG4gIH1cbiAgcG9zKCk6IHA1LlZlY3RvciB7XG4gICAgcmV0dXJuIHRoaXMuYS5jb3B5KCk7XG4gIH1cbiAgdHJhbnNsYXRlKG9mZnNldDogcDUuVmVjdG9yKSB7XG4gICAgdGhpcy5hLmFkZChvZmZzZXQpO1xuICAgIHRoaXMuYi5hZGQob2Zmc2V0KTtcbiAgfVxuICBkcmF3U2hhZG93KCkge1xuICAgIGNvbnN0IG9mZiA9IGNyZWF0ZVZlY3RvcigyMCwgMTApO1xuICAgIHN0cm9rZShjb2xvcih0aGlzLm15SHVlLCAwLCAwLCAyMCkpO1xuICAgIG5vRmlsbCgpO1xuICAgIHN0cm9rZVdlaWdodCh0aGlzLnRoaWNrbmVzcyk7XG4gICAgbGluZShcbiAgICAgIG9mZi54ICsgdGhpcy5hLngsXG4gICAgICBvZmYueSArIHRoaXMuYS55LFxuICAgICAgb2ZmLnggKyB0aGlzLmIueCxcbiAgICAgIG9mZi55ICsgdGhpcy5iLnlcbiAgICApO1xuICB9XG4gIGRyYXdTaWxob3V0dGUoKSB7XG4gICAgbm9GaWxsKCk7XG4gICAgc3Ryb2tlKDEwKTtcbiAgICBzdHJva2VXZWlnaHQodGhpcy50aGlja25lc3MpO1xuICAgIGxpbmUodGhpcy5hLngsIHRoaXMuYS55LCB0aGlzLmIueCwgdGhpcy5iLnkpO1xuICB9XG4gIGRyYXdJbm5lcigpIHtcbiAgICAvL3N0cm9rZUNhcChTUVVBUkUpO1xuICAgIHN0cm9rZSh0aGlzLm15Q29sb3IpO1xuICAgIHN0cm9rZVdlaWdodCh0aGlzLnRoaWNrbmVzcyAqIDAuOCk7XG4gICAgbGluZSh0aGlzLmEueCwgdGhpcy5hLnksIHRoaXMuYi54LCB0aGlzLmIueSk7XG4gIH1cbiAgc3RhdGljIGRyYXdDcm9zc2hhaXJBdChwb3M6IHA1LlZlY3RvciwgY29scjogcDUuQ29sb3IpIHtcbiAgICBzdHJva2VXZWlnaHQoMS44KTtcbiAgICBzdHJva2UoY29scik7XG4gICAgcHVzaCgpO1xuICAgIHRyYW5zbGF0ZShwb3MueCwgcG9zLnkpO1xuICAgIGxpbmUoLTgsIDAsIDgsIDApO1xuICAgIGxpbmUoMCwgLTgsIDAsIDgpO1xuICAgIHBvcCgpO1xuICB9XG4gIG1pZFBvaW50KCk6IHA1LlZlY3RvciB7XG4gICAgcmV0dXJuIHRoaXMuYS5jb3B5KCkubGVycCh0aGlzLmIsIDAuNSk7XG4gIH1cblxuICBzdGF0aWMgY3JlYXRlUmFuZG9tQXQoXG4gICAgaWQ6IHN0cmluZyxcbiAgICBwb3NBOiBwNS5WZWN0b3IsXG4gICAgdGFyZ2V0OiBUYXJnZXRQcm92aWRlcixcbiAgICB0aGlja25lc3NTY2FsZTogbnVtYmVyLFxuICAgIG1heFRoaWNrbmVzczogbnVtYmVyLFxuICAgIGxlbjogbnVtYmVyLFxuICAgIG15SHVlOiBudW1iZXJcbiAgKSB7XG4gICAgY29uc3QgcDEgPSBwb3NBLmNvcHkoKTtcbiAgICBjb25zdCBwMiA9IHAxLmNvcHkoKS5hZGQocDUuVmVjdG9yLnJhbmRvbTJEKCkubXVsdChsZW4pKTtcbiAgICByZXR1cm4gbmV3IFNlZ21lbnQoaWQsIHAxLCBwMiwgdGFyZ2V0LCB0aGlja25lc3NTY2FsZSwgbWF4VGhpY2tuZXNzLCBteUh1ZSk7XG4gIH1cbiAgdXBkYXRlKCk6IHZvaWQge1xuICAgIHRoaXMuc2Vla1RhcmdldCh0aGlzLnRhcmdldC5wb3MoKSk7XG4gIH1cblxuICBzZWVrVGFyZ2V0KHRhcmdldFBvczogcDUuVmVjdG9yKTogdm9pZCB7XG4gICAgY29uc3QgZGVsdGFUb1RhcmdldCA9IHRhcmdldFBvcy5jb3B5KCkuc3ViKHRoaXMuYSk7XG4gICAgdGhpcy5kZWx0YVRvVGFyZ2V0ID0gZGVsdGFUb1RhcmdldDtcbiAgICB0aGlzLmEgPSB0YXJnZXRQb3MuY29weSgpLmFkZChcbiAgICAgIGRlbHRhVG9UYXJnZXRcbiAgICAgICAgLmNvcHkoKVxuICAgICAgICAubm9ybWFsaXplKClcbiAgICAgICAgLm11bHQoLXRoaXMubGVuKVxuICAgICk7XG4gICAgdGhpcy5iID0gdGFyZ2V0UG9zLmNvcHkoKTtcbiAgfVxufVxuIiwiaW50ZXJmYWNlIFRhcmdldFByb3ZpZGVyIHtcbiAgcG9zKCk6IHA1LlZlY3Rvcjtcbn1cblxuY2xhc3MgVGVudGFjbGUge1xuICBzZWdtZW50czogU2VnbWVudFtdO1xuICBwcm92aWRlVGFyZ2V0OiBUYXJnZXRQcm92aWRlcjtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBudW1TZWdtZW50czogbnVtYmVyLFxuICAgIGZ1bGxMZW5ndGg6IG51bWJlcixcbiAgICBtYXhUaGlja25lc3M6IG51bWJlcixcbiAgICBiYXNlSHVlT2YxMDA6IG51bWJlcixcbiAgICBwcm92aWRlVGFyZ2V0OiBUYXJnZXRQcm92aWRlclxuICApIHtcbiAgICBjb25zdCBteUh1ZSA9IHJhbmRvbShiYXNlSHVlT2YxMDAgLSA1LCBiYXNlSHVlT2YxMDAgKyA1KTtcbiAgICBjb25zdCBhdmdTZWdtZW50TGVuZ3RoID0gZnVsbExlbmd0aCAvIG51bVNlZ21lbnRzO1xuICAgIHRoaXMucHJvdmlkZVRhcmdldCA9IHByb3ZpZGVUYXJnZXQ7XG5cbiAgICBsZXQgcHJldlBvczogcDUuVmVjdG9yID0gY3JlYXRlVmVjdG9yKFxuICAgICAgcmFuZG9tKHdpZHRoICogMC40LCB3aWR0aCAqIDAuNiksXG4gICAgICBoZWlnaHQgKiAxLjFcbiAgICApO1xuICAgIHRoaXMuc2VnbWVudHMgPSBjb2xsZWN0RGlzdHJpYnV0ZWRCZXR3ZWVuKFxuICAgICAgbnVtU2VnbWVudHMsXG4gICAgICAwLFxuICAgICAgMC45LFxuICAgICAgKHRoaWNrbmVzcywgaXgpID0+IHtcbiAgICAgICAgY29uc3Qgc2VnbWVudCA9IFNlZ21lbnQuY3JlYXRlUmFuZG9tQXQoXG4gICAgICAgICAgXCJTZWdcIiArIGl4LFxuICAgICAgICAgIHByZXZQb3MsXG4gICAgICAgICAgbnVsbCxcbiAgICAgICAgICAxIC0gdGhpY2tuZXNzLFxuICAgICAgICAgIG1heFRoaWNrbmVzcyxcbiAgICAgICAgICBhdmdTZWdtZW50TGVuZ3RoLFxuICAgICAgICAgIG15SHVlXG4gICAgICAgICk7XG4gICAgICAgIHByZXZQb3MgPSBzZWdtZW50LmIuY29weSgpO1xuICAgICAgICByZXR1cm4gc2VnbWVudDtcbiAgICAgIH1cbiAgICApO1xuICAgIHRoaXMuc2VnbWVudHNbMF0uaXNGaXhlZCA9IHRydWU7XG5cbiAgICBsZXQgdGhpbm5lclNlZ21lbnQ6IFNlZ21lbnQgPSBudWxsO1xuICAgIHRoaXMuc2VnbWVudHMucmV2ZXJzZSgpLmZvckVhY2goc2VnID0+IHtcbiAgICAgIHNlZy50YXJnZXQgPSB0aGlubmVyU2VnbWVudCA/IHRoaW5uZXJTZWdtZW50IDogdGhpcy5wcm92aWRlVGFyZ2V0O1xuICAgICAgdGhpbm5lclNlZ21lbnQgPSBzZWc7XG4gICAgfSk7XG4gICAgdGhpcy5zZWdtZW50cy5yZXZlcnNlKCk7XG4gIH1cbiAgbGFzdFNlZ21lbnQoKTogU2VnbWVudCB7XG4gICAgcmV0dXJuIHRoaXMuc2VnbWVudHMubGVuZ3RoID4gMFxuICAgICAgPyB0aGlzLnNlZ21lbnRzW3RoaXMuc2VnbWVudHMubGVuZ3RoIC0gMV1cbiAgICAgIDogdW5kZWZpbmVkO1xuICB9XG4gIGZpcnN0U2VnbWVudCgpOiBTZWdtZW50IHtcbiAgICByZXR1cm4gdGhpcy5zZWdtZW50cy5sZW5ndGggPiAwID8gdGhpcy5zZWdtZW50c1swXSA6IHVuZGVmaW5lZDtcbiAgfVxuICBzZXROZXdUYXJnZXRQcm92aWRlcihnaXZlblRhcmdldFByb3ZpZGVyOiBUYXJnZXRQcm92aWRlcik6IHZvaWQge1xuICAgIHRoaXMucHJvdmlkZVRhcmdldCA9IGdpdmVuVGFyZ2V0UHJvdmlkZXI7XG4gICAgdGhpcy5sYXN0U2VnbWVudCgpLnRhcmdldCA9IGdpdmVuVGFyZ2V0UHJvdmlkZXI7XG4gIH1cbiAgdXBkYXRlKCkge1xuICAgIGNvbnN0IG9yaWdpbmFsTG9ja2VkUG9zID0gdGhpcy5zZWdtZW50c1swXS5hLmNvcHkoKTtcbiAgICB0aGlzLnNlZ21lbnRzLnJldmVyc2UoKTtcbiAgICBmb3IgKGxldCBzIG9mIHRoaXMuc2VnbWVudHMpIHtcbiAgICAgIHMudXBkYXRlKCk7XG4gICAgfVxuICAgIHRoaXMuc2VnbWVudHMucmV2ZXJzZSgpO1xuICAgIGNvbnN0IG1vdmVCYWNrRGVsdGEgPSBvcmlnaW5hbExvY2tlZFBvc1xuICAgICAgLmNvcHkoKVxuICAgICAgLnN1Yih0aGlzLnNlZ21lbnRzWzBdLmEuY29weSgpKTtcbiAgICB0aGlzLnNlZ21lbnRzLmZvckVhY2gocyA9PiBzLnRyYW5zbGF0ZShtb3ZlQmFja0RlbHRhKSk7XG4gIH1cblxuICBkcmF3KCkge1xuICAgIGlmIChhcHBPcHRpb25zLnNob3VsZERyYXdTaGFkb3dzKSB7XG4gICAgICBmb3IgKGxldCBzIG9mIHRoaXMuc2VnbWVudHMpIHtcbiAgICAgICAgcy5kcmF3U2hhZG93KCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChsZXQgcyBvZiB0aGlzLnNlZ21lbnRzKSB7XG4gICAgICBzLmRyYXdTaWxob3V0dGUoKTtcbiAgICB9XG4gICAgZm9yIChsZXQgcyBvZiB0aGlzLnNlZ21lbnRzKSB7XG4gICAgICBzLmRyYXdJbm5lcigpO1xuICAgIH1cbiAgfVxufVxuIiwiZnVuY3Rpb24gcmFuZG9tU2NyZWVuUG9zaXRpb24oKTogcDUuVmVjdG9yIHtcbiAgcmV0dXJuIGNyZWF0ZVZlY3RvcihyYW5kb20od2lkdGgpLCByYW5kb20oaGVpZ2h0KSk7XG59XG5cbmZ1bmN0aW9uIGNlbnRlclNjcmVlblBvcygpOiBwNS5WZWN0b3Ige1xuICByZXR1cm4gY3JlYXRlVmVjdG9yKHdpZHRoIC8gMiwgaGVpZ2h0IC8gMik7XG59XG5cbmZ1bmN0aW9uIHJhbmRvbUludChtaW46IG51bWJlciwgbWF4OiBudW1iZXIpOiBudW1iZXIge1xuICByZXR1cm4gcm91bmQocmFuZG9tKG1pbiwgbWF4KSk7XG59XG5cbmZ1bmN0aW9uIHRyYW5zbGF0ZVRvVmVjKHBvczogcDUuVmVjdG9yKTogdm9pZCB7XG4gIHRyYW5zbGF0ZShwb3MueCwgcG9zLnkpO1xufVxuZnVuY3Rpb24gcm90YXRlVmVydGV4QXJvdW5kKFxuICB2ZXJ0ZXg6IHA1LlZlY3RvcixcbiAgcm90T3JpZ2luOiBwNS5WZWN0b3IsXG4gIGFuZ2xlUmFkOiBudW1iZXJcbik6IHA1LlZlY3RvciB7XG4gIHJldHVybiB2ZXJ0ZXhcbiAgICAuY29weSgpXG4gICAgLnN1Yihyb3RPcmlnaW4pXG4gICAgLnJvdGF0ZShhbmdsZVJhZClcbiAgICAuYWRkKHJvdE9yaWdpbik7XG59XG5cbi8qKiBGaW5kIHRoZSBtaW5pbXVtIG9mIHRoZSBnaXZlbiBsaXN0IGFmdGVyIGFwcGx5aW5nIGZuKCkgdG8gZWFjaC5cbiAqIFJldHVybiB0aGUgbWluaW11bSwgZmlyc3QgbWluaW11bSwgb3IgdW5kZWZpbmVkIGlmIHRoZXJlIGFyZSBubyBpdGVtcy5cbiAqL1xuZnVuY3Rpb24gbWluQnk8VD4obGlzdDogVFtdLCBmbjogKGl0ZW06IFQpID0+IG51bWJlcik6IFQge1xuICBpZiAobGlzdC5sZW5ndGggPCAwKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuICBsZXQgcmVjb3JkSXRlbSA9IGxpc3RbMF07XG4gIGxldCByZWNvcmRXZWlnaHQgPSBmbihsaXN0WzBdKTtcbiAgZm9yIChsZXQgaXRlbSBvZiBsaXN0KSB7XG4gICAgY29uc3Qgd2VpZ2h0ID0gZm4oaXRlbSk7XG4gICAgaWYgKHdlaWdodCA+IHJlY29yZFdlaWdodCkge1xuICAgICAgcmVjb3JkV2VpZ2h0ID0gd2VpZ2h0O1xuICAgICAgcmVjb3JkSXRlbSA9IGl0ZW07XG4gICAgfVxuICB9XG4gIHJldHVybiByZWNvcmRJdGVtO1xufVxuXG4vKiogUmVwZWF0ZWRseSBjYWxsIHRoZSBnaXZlbiBmdW5jdGlvbiBmbiwgbnVtIHRpbWVzLCB0aHJvd2luZyBhbnkgb3V0cHV0IGF3YXkuICovXG5mdW5jdGlvbiByZXBlYXQobnVtOiBudW1iZXIsIGZuOiAoaXg6IG51bWJlcikgPT4gdm9pZCkge1xuICBmb3IgKGxldCBpID0gMDsgaSA8IG51bTsgaSsrKSB7XG4gICAgZm4oaSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZGlzdHJpYnV0ZVVwVG8odG90YWw6IG51bWJlciwgbWF4OiBudW1iZXIsIGZuOiAodjogbnVtYmVyKSA9PiB2b2lkKSB7XG4gIHJlcGVhdCh0b3RhbCwgaXggPT4ge1xuICAgIGNvbnN0IHZhbCA9IChpeCAqIG1heCkgLyB0b3RhbDtcbiAgICByZXR1cm4gZm4odmFsKTtcbiAgfSk7XG59XG4vKiogXG5Db2xsZWN0IGEgc2V0IG9mIHZhbHVlcyBnZW5lcmF0ZWQgd2l0aCBmbiBjYWxsZWQgd2l0aCBcbmEgcmFuZ2Ugb2YgbnVtU2FtcGxlcyBzYW1wbGVzIGRpc3RyaWJ1dGVkIGV2ZW5seSBmcm9tIG1pbiB0byBtYXguXG4qL1xuZnVuY3Rpb24gY29sbGVjdERpc3RyaWJ1dGVkQmV0d2VlbjxUPihcbiAgbnVtU2FtcGxlczogbnVtYmVyLFxuICBtaW46IG51bWJlcixcbiAgbWF4OiBudW1iZXIsXG4gIGZuOiAodjogbnVtYmVyLCBpeD86IG51bWJlcikgPT4gVFxuKTogVFtdIHtcbiAgY29uc3QgcmVzdWx0OiBUW10gPSBbXTtcbiAgZGlzdHJpYnV0ZUJldHdlZW4obnVtU2FtcGxlcywgbWluLCBtYXgsICh2LCBpeCkgPT4gcmVzdWx0LnB1c2goZm4odiwgaXgpKSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBkaXN0cmlidXRlQmV0d2VlbihcbiAgbnVtU2FtcGxlczogbnVtYmVyLFxuICBtaW46IG51bWJlcixcbiAgbWF4OiBudW1iZXIsXG4gIGZuOiAodjogbnVtYmVyLCBpeD86IG51bWJlcikgPT4gdm9pZFxuKSB7XG4gIHJlcGVhdChudW1TYW1wbGVzLCBpeCA9PiB7XG4gICAgY29uc3QgcmFuZ2UgPSBtYXggLSBtaW47XG4gICAgY29uc3QgdmFsID0gbWluICsgKGl4ICogcmFuZ2UpIC8gbnVtU2FtcGxlcztcbiAgICByZXR1cm4gZm4odmFsLCBpeCk7XG4gIH0pO1xufVxuZnVuY3Rpb24gYXZlcmFnZVZlY3RvcnModnM6IHA1LlZlY3RvcltdKTogcDUuVmVjdG9yIHtcbiAgaWYgKHZzLmxlbmd0aCA8IDEpIHtcbiAgICByZXR1cm4gY3JlYXRlVmVjdG9yKDAsIDApO1xuICB9XG4gIHJldHVybiB2cy5yZWR1Y2UoKHYxLCB2MikgPT4gdjEuY29weSgpLmFkZCh2MiksIHZzWzBdKS5kaXYodnMubGVuZ3RoKTtcbn1cblxuZnVuY3Rpb24gcmFuZG9tQm9vbGVhbigpOiBib29sZWFuIHtcbiAgcmV0dXJuIE1hdGgucmFuZG9tKCkgPiAwLjU7XG59XG5mdW5jdGlvbiBtb3VzZVBvc0FzVmVjdG9yKCk6IHA1LlZlY3RvciB7XG4gIHJldHVybiBjcmVhdGVWZWN0b3IobW91c2VYLCBtb3VzZVkpO1xufVxuZnVuY3Rpb24gY29sbGVjdDxUPihuOiBudW1iZXIsIGZuOiAoaXg6IG51bWJlcikgPT4gVCk6IFRbXSB7XG4gIGNvbnN0IHJlcyA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IG47IGkrKykge1xuICAgIHJlcy5wdXNoKGZuKGkpKTtcbiAgfVxuICByZXR1cm4gcmVzO1xufVxuIl19